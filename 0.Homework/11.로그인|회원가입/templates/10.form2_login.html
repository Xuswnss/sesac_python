<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bootstrap</title>
    <!-- bootstrap css -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
    />
  </head>
  <body>
    <div class="container mt-4">
      <!-- 사용자명 (3-10) 글자로 -->
      <form action="" novalidate>
        <div class="mb-3">
          <label for="usernameInput" class="form-label">아이디</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-person"></i> </span>
            <input
              type="text"
              class="form-control"
              id="username"
              placeholder="3글자 이상 10글자 이하 "
            />
            <div class="invalid-feedback">
              사용자명은 3글자 이상 10글자 이하로 작성해주세요
            </div>
          </div>
        </div>
        <!-- 비밀번호 (대소문자 숫자 특수문자를 포함하여 8자 이상) -->
        <div class="mb-3">
          <label for="password" class="form-label">비밀번호</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-key-fill"></i></span>
            <input
              type="password"
              class="form-control"
              id="password"
              placeholder="대소문자, 숫자, 특수문자를 포함하여 8자 이상"
            />
            <div class="invalid-feedback">
              비밀번호는 대소문자, 숫자, 특수문자를 포함해야 합니다
            </div>
          </div>
        </div>
        <!-- 이름(1-10)글자 -->
        <div class="mb-3">
          <label for="name" class="form-label">이름</label>
          <div class="input-group">
            <span class="input-group-text"
              ><i class="bi bi-person-circle"></i
            ></span>
            <input
              type="text"
              class="form-control"
              id="name"
              placeholder="1글자 이상 10글자 이하"
            />
            <div class="invalid-feedback">
              이름은 1글자 이상 10글자 이하로 작성해주세요
            </div>
          </div>
        </div>
        <!-- 생년월일 -->
        <div class="mb-3">
          <label for="birth" class="form-label">생년월일</label>
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-calendar"></i></span>
            <input type="date" class="form-control"  id="birth"/>
            <div class="invalid-feedback">생년월일을 입력해주세요</div>
          </div>
        </div>
        <!-- 관심분야 (최소1개에서 최대 4개_) -->
        <!-- 관심분야 (최소 1개에서 최대 4개) -->
        <div class="mb-3">
          <label class="form-label">관심분야 (최소 1개 ~ 최대 4개)</label>
          <div class="input-group">
            <div class="form-control" style="border: none">
              <div class="form-check form-check-inline">
                 <label class="form-check-label " for="field1">AI</label>
                <input
                  class="form-check-input interest"
                  type="checkbox"
                  id="field1"
                  value="AI"
                />
               
              </div>
              <div class="form-check form-check-inline">
                  <label class="form-check-label" for="field2">빅데이터</label>
                <input
                  class="form-check-input interest"
                  type="checkbox"
                  id="field2"
                  value="빅데이터"
                />
              
              </div>
              <div class="form-check form-check-inline">
                 <label class="form-check-label" for="field3">웹개발</label>
                <input
                  class="form-check-input interest"
                  type="checkbox"
                  id="field3"
                  value="웹개발"
                />
               
              </div>
              <div class="form-check form-check-inline">
                 <label class="form-check-label" for="field4">보안</label>
                <input
                  class="form-check-input interest"
                  type="checkbox"
                  id="field4"
                  value="보안"
                />
               
              </div>
              <div class="form-check form-check-inline">
                 <label class="form-check-label" for="field5">게임</label>
                <input
                  class="form-check-input interest"
                  type="checkbox"
                  id="field5"
                  value="게임"
                />
               
              </div>
            </div>
            <div class="invalid-feedback" id="interestError">
              관심분야는 최소 1개, 최대 4개까지 선택해주세요.
            </div>
          </div>
        </div>
        <!-- 제출 -->
        <input type="submit" class="btn btn-primary" />
      </form>
    </div>
    <script>
      // 1. 입력 요소 가져오기
      const form = document.getElementById("validationForm");
      const usernameInput = document.getElementById("username");
      const passwordInput = document.getElementById("password");
      const nameInput = document.getElementById("name");
      const birthInput = document.getElementById("birth");
      const interestCheckboxes = document.querySelectorAll(".interest");
      const interestError = document.getElementById("interestError");

  

      // 아이디: 3글자 이상 10글자 이하
      function validateUsername() {
        const value = usernameInput.value.trim();
        if (value.length >= 3 && value.length <= 10) {
          usernameInput.classList.remove("is-invalid");
          usernameInput.classList.add("is-valid");
        } else {
          usernameInput.classList.remove("is-valid");
          usernameInput.classList.add("is-invalid");
        }
      }

      // 비밀번호: 대문자, 소문자, 숫자, 특수문자 포함 8자 이상
      function validatePassword() {
        const value = passwordInput.value;
        const rule = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;
        if (rule.test(value)) {
          passwordInput.classList.remove("is-invalid");
          passwordInput.classList.add("is-valid");
        } else {
          passwordInput.classList.remove("is-valid");
          passwordInput.classList.add("is-invalid");
        }
      }

      // 이름: 1글자 이상 10글자 이하
      function validateName() {
        const value = nameInput.value.trim();
        if (value.length >= 1 && value.length <= 10) {
          nameInput.classList.remove("is-invalid");
          nameInput.classList.add("is-valid");
        } else {
          nameInput.classList.remove("is-valid");
          nameInput.classList.add("is-invalid");
        }
      }

      // 생년월일: 입력했는지 확인
      function validateBirth() {
        if (birthInput.value) {
          birthInput.classList.remove("is-invalid");
          birthInput.classList.add("is-valid");
        } else {
          birthInput.classList.remove("is-valid");
          birthInput.classList.add("is-invalid");
        }
      }

      // 관심분야: 1개 이상, 4개 이하 선택했는지 확인
      function validateInterest() {
        let checkedCount = 0;

        // 체크된 개수 세기
        interestCheckboxes.forEach((checkbox) => {
          if (checkbox.checked) {
            checkedCount++;
            console.log(checkbox.value)
          }
        });

        // 조건 확인
        if (checkedCount >= 1 && checkedCount < 4) {
          interestError.classList.remove("is-invalid");
          interestError.classList.add("is-valid");
          return true;
        } else {
          interestError.classList.remove("is-valid");
          interestError.classList.add("is-invalid");
          return false;
        }
      }

      // 3. 입력칸에 포커스 벗어날 때 유효성 검사 실행
      usernameInput.addEventListener("blur", validateUsername);
      passwordInput.addEventListener("blur", validatePassword);
      nameInput.addEventListener("blur", validateName);
      birthInput.addEventListener("blur", validateBirth);
      interestCheckboxes.forEach((checkbox) => {
        checkbox.addEventListener("change", validateInterest);
      });

      // 4. 폼 제출 시 전체 검사 실행
      form.addEventListener("submit", function (event) {
        event.preventDefault(); // 실제 전송 막기 (개발 중이니까)

        // 각 입력값 검사 실행
        validateUsername();
        validatePassword();
        validateName();
        validateBirth();
        const interestValid = validateInterest();

        // 모든 입력칸이 'is-valid'이고, 관심분야도 조건 만족할 때만 통과
        const isAllValid =
          document.querySelectorAll(".is-invalid").length == 0 &&
          interestValid;

        if (isAllValid) {
          alert("폼이 성공적으로 제출됩니다!");
          // 실제 전송: form.submit();
        } else {
          alert("입력값을 다시 확인해주세요.");
        }
      });
    </script>

    <!-- bootstrap js-->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
