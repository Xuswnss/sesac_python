<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Register</title>
  
  <!-- bootstrap css -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
    crossorigin="anonymous"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
  />
</head>
<body>
  <div class="container mt-5">

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

   
<form action="" method="POST">
  <h2>Register</h2>

  <!-- 이름 -->
  <label for="name" class="form-label">Name</label>
  <div class="input-group mb-3">
    <span class="input-group-text"><i class="bi bi-person-circle"></i></span>
    <input type="text" class="form-control" id="name" name="name" placeholder="이름을 입력해주세요" required>
  </div>

  <!-- 아이디 -->
  <label for="id" class="form-label">ID</label>
  <div class="input-group mb-3">
    <span class="input-group-text"><i class="bi bi-person-circle"></i></span>
    <input type="text" class="form-control" id="id" name="id" placeholder="아이디를 입력해주세요" required>
  </div>

  <!-- 이메일 -->
  <label for="email" class="form-label">Email</label>
  <div class="input-group mb-3">
    <span class="input-group-text"><i class="bi bi-envelope"></i></span>
    <input type="email" class="form-control" id="email" name="email" placeholder="이메일을 입력해주세요" required>
    <button class="btn btn-outline-secondary" type="button" id="sendEmail">Send</button>
  </div>

  <!-- 인증번호 -->
  <label for="certification" class="form-label">Certification number</label>
  <div class="input-group mb-3">
    <span class="input-group-text"><i class="bi bi-patch-check"></i></span>
    <input type="text" class="form-control" id="certification" name="certification" placeholder="인증번호를 입력해주세요">
    <button class="btn btn-outline-secondary" type="button" id="verifyCode">Certification</button>
  </div>

  <!-- 비밀번호 -->
  <label for="password" class="form-label">Password</label>
  <div class="input-group mb-3">
    <span class="input-group-text"><i class="bi bi-key-fill"></i></span>
    <input type="password" class="form-control" id="password" name="password" placeholder="비밀번호를 입력해주세요" required>
  </div>

  <!-- 비밀번호 확인 -->
  <label for="password2" class="form-label">Check Password</label>
  <div class="input-group mb-3">
    <span class="input-group-text"><i class="bi bi-key-fill"></i></span>
    <input type="password" class="form-control" id="password2" name="password2" placeholder="비밀번호를 재입력해주세요" required>
  </div>

  <!-- 회원가입 버튼 -->
  <button type="submit" class="btn btn-outline-primary mt-2">회원가입</button>

  <!-- 카카오 로그인 -->
  <a href="/login/kakao">
    <img src="../static/kakao_login_large.png" style="width: 81.37px;" class="mt-2" alt="카카오 로그인">
  </a>
</form>

<script>
  document.getElementById("sendEmail").onclick = function() {
    const email = document.getElementById("email").value;
    if (!email) {
      alert("이메일을 입력해주세요");
      return;
    }

    fetch("/api/send-email-code", {
      method: "POST",
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ email: email })
    })
    .then(response => response.json())
    .then(data => alert(data.message))
    .catch(err => alert("이메일 전송 실패"));
  };

  document.getElementById("verifyCode").onclick = function() {
    const code = document.getElementById("certification").value;
    fetch("/verify-code", {
      method: "POST",
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ code: code })
    })
    .then(res => res.json())
    .then(data => alert(data.message));
  };
</script>

</script>
  <!-- bootstrap js -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
    crossorigin="anonymous"
  ></script>


</body>
</html>
